import{h as F,r as i,j as e,ac as _,m as q,am as T,an as O,ao as ae,A as re,ap as le,aq as ie,a as ne,ar as oe,i as P,Y as ce,as as de,at as me,L as U,au as xe,av as he,Q as ue,D as I,a1 as pe,x as ge,aw as je,ax as fe,ay as ye,az as be,R as Ne,a3 as we,u as ve,a9 as ke,ab as Ce,aA as Se,aB as Ae}from"./index-QpwFg_DK.js";import{M as Me}from"./MessagesSendingRecieving-BZnNPbMp.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=F("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=F("FilePen",[["path",{d:"M12.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v9.5",key:"1couwa"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1y4qbx"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=F("Satellite",[["path",{d:"M13 7 9 3 5 7l4 4",key:"vyckw6"}],["path",{d:"m17 11 4 4-4 4-4-4",key:"rchckc"}],["path",{d:"m8 12 4 4 6-6-4-4Z",key:"1sshf7"}],["path",{d:"m16 8 3-3",key:"x428zp"}],["path",{d:"M9 21a6 6 0 0 0-6-6",key:"1iajcf"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=F("UserRoundCheck",[["path",{d:"M2 21a8 8 0 0 1 13.292-6",key:"bjp14o"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"m16 19 2 2 4-4",key:"1b14m6"}]]);function Ie({electricaURL:g,projectId:C,stageName:y}){var S,N,A;const[a,v]=i.useState([]),[p,b]=i.useState(!0),[j,f]=i.useState(null);return i.useEffect(()=>{const r=async()=>{f(null);try{const s=await P.post(`${g}/api/adminauth/getstage`,{projectId:C,stageName:y},{withCredentials:!0});s.status===200&&v(s.data)}catch{f("Failed to fetch stage data. Please try again.")}finally{b(!1)}},o=setTimeout(()=>r(),6e3);return()=>clearTimeout(o)},[C,y,g]),j?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsxs("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4",role:"alert",children:[e.jsx("p",{className:"font-bold",children:"Error"}),e.jsx("p",{children:j})]})}):p?e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(_,{})}):e.jsx("div",{className:"stage-container lg:max-w-6xl w-full mx-auto lg:p-5 p-1",children:e.jsx(q.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.8},className:"border border-solid border-gray-200/5 shadow-2xl overflow-hidden",children:e.jsxs("div",{className:"lg:p-6 p-2 space-y-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-white mb-4 border-b border-gray-700 pb-2",children:y}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-500/50 backdrop-blur p-4 rounded-lg shadow-inner",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx(Fe,{}),e.jsx("h3",{className:"text-xl font-semibold text-gray-200 mb-2",children:"Status"})]}),e.jsx("p",{className:"flex items-center space-x-2",children:a!=null&&a.isCompleted?e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"text-green-500"}),e.jsx("span",{className:"text-green-400",children:"Completed"})]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"text-yellow-500"}),e.jsx("span",{className:"text-yellow-400",children:"In Progress"})]})})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg shadow-inner",children:[e.jsxs("div",{className:"flex item-center gap-2",children:[e.jsx(qe,{}),e.jsx("h3",{className:"text-xl font-semibold text-gray-200 mb-2",children:"Client Confirmation"})]}),e.jsx("p",{className:"flex items-center space-x-2",children:(S=a==null?void 0:a.clientConfirmation)!=null&&S.isConfirmed?e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"text-green-500"}),e.jsx("span",{className:"text-green-400",children:"Confirmed"})]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"text-red-500"}),e.jsx("span",{className:"text-red-400",children:"Not Confirmed"})]})})]})]}),((N=a==null?void 0:a.clientConfirmation)==null?void 0:N.emergencyMessage)&&e.jsxs("div",{className:"bg-yellow-900 border-l-4 border-yellow-500 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ae,{className:"text-yellow-500 mr-2"}),e.jsx("p",{className:"text-yellow-200 font-semibold",children:"Emergency Message:"})]}),e.jsx("p",{className:"text-yellow-100 mt-2",children:((A=a==null?void 0:a.clientConfirmation)==null?void 0:A.emergencyMessage)||"Emergeny not available"})]}),e.jsx("h3",{className:"text-2xl font-bold text-white mt-8 mb-4",children:"Updates"}),e.jsx(re,{children:Array.isArray(a==null?void 0:a.updates)&&a.updates.length>0?a.updates.map((r,o)=>e.jsx(q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.5,delay:o*.1},className:"mb-6",children:e.jsxs("details",{className:"bg-gray-800 rounded-lg shadow-lg overflow-hidden",children:[e.jsxs("summary",{className:"cursor-pointer p-4 flex justify-between items-center bg-gray-700 hover:bg-gray-600 transition-colors duration-300",children:[e.jsxs("span",{className:"text-lg font-semibold text-white",children:["Update: ",new Date(r.date).toLocaleDateString()]}),e.jsx(le,{className:"text-gray-400 transform transition-transform duration-300"})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold text-blue-400 flex items-center mb-2",children:[e.jsx(ie,{className:"mr-2"})," Materials Used"]}),e.jsx("ul",{className:"list-disc pl-5 space-y-1",children:Array.isArray(r==null?void 0:r.materialsUsed)&&r.materialsUsed.length>0?r.materialsUsed.map((s,t)=>e.jsxs("li",{className:"text-gray-300",children:[s.name||"Unnamed Material"," | Quantity -",s.quantity||"N/A"]},t)):e.jsx("li",{className:"text-gray-400 italic",children:"No materials used"})})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold text-green-400 flex items-center mb-2",children:[e.jsx(ne,{className:"mr-2"})," Workers Involved"]}),e.jsx("ul",{className:"list-disc pl-5 space-y-1",children:Array.isArray(r.workers)&&r.workers.length>0?r.workers.map((s,t)=>e.jsxs("li",{className:"text-gray-300",children:[s.name," - daily wage = ",s.dailyWage]},t)):e.jsx("li",{className:"text-gray-400 italic",children:"No workers involved"})})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold text-purple-400 flex items-center mb-2",children:[e.jsx(oe,{className:"mr-2"})," Images"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:Array.isArray(r.images)&&r.images.length>0?r.images.map((s,t)=>e.jsx("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"block",children:e.jsx("img",{src:s,alt:`Update ${t+1}`,className:"w-full h-32 object-cover rounded-lg hover:opacity-75 transition-opacity duration-300"})},t)):e.jsx("p",{className:"text-gray-400 italic",children:"No images available"})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-yellow-400 mb-2",children:"Details"}),e.jsx("p",{className:"text-gray-300",children:r.details||"No details provided"})]})]})]})},o)):e.jsx(q.p,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"text-gray-400 italic",children:"No updates available for this stage."})})]})})})}const De=({projectId:g,electricaURL:C,stageName:y,onCompleteStage:a})=>{const[v,p]=i.useState(!1),[b,j]=i.useState(!1),f=i.useRef(null);i.useEffect(()=>{const o=s=>{f.current&&!f.current.contains(s.target)&&p(!1)};return document.addEventListener("mousedown",o),()=>{document.removeEventListener("mousedown",o)}},[v]);const S=()=>{p(o=>!o)},N=()=>{a&&a(g,y),p(!1)},A=()=>{j(!0),p(!1)},r=()=>{j(!1)};return e.jsxs("div",{className:"relative",children:[e.jsx("button",{className:"icons cursor-pointer text-xl text-white flex justify-center items-center h-12 w-12 rounded-full hover:bg-red-500/80 transition-all focus:outline-none",onClick:S,title:"Options","aria-expanded":v,"aria-label":"Dropdown Menu",children:e.jsx(ce,{icon:de})}),v&&e.jsx("div",{ref:f,className:"absolute top-full mt-2 right-0 w-64 bg-gray-900 text-white rounded-lg shadow-lg z-50 transition-transform transform origin-top-right scale-100",children:e.jsxs("ul",{className:"flex flex-col space-y-3 p-4",children:[e.jsx("li",{children:e.jsxs("button",{onClick:A,className:"text-sm bg-blue-600 hover:bg-blue-700 text-white rounded-md py-2 px-3 text-center transition-all flex items-center gap-2",children:[e.jsx(me,{})," Notify Client"]})}),e.jsx("li",{children:e.jsx("button",{onClick:N,className:"block text-sm bg-green-600 hover:bg-green-700 text-white rounded-md py-2 px-3 text-center transition-all",children:"Complete Stage"})}),e.jsx("li",{children:e.jsx(U,{className:"block text-sm bg-gray-800 hover:bg-gray-700 text-white rounded-md py-2 px-3 text-center transition-all",to:`/db_au_admn/projectusers/stageone/${g}/addmaterial/${y}`,children:"Add Material"})})]})}),b&&e.jsx(xe,{onClose:r,projectId:g,baackendURL:C,stageName:y})]})},We=({updates:g,setUpdates:C,stageName:y,project:a,handleWorkerChange:v,handleAddWorker:p,handleRemoveWorker:b,handleSubmit:j,formLoader:f})=>{const[S,N]=i.useState([]),A=(s,t)=>{C(n=>{const c=[...n[0].materialsUsed];return c[s]={...c[s],quantity:Math.max(0,parseInt(t,10))},[{...n[0],materialsUsed:c}]})},r=s=>{const t=s.target.files;if(t){const n=Array.from(t).map(c=>URL.createObjectURL(c));N(c=>[...c,...n])}},o=s=>{N(t=>t.filter((n,c)=>c!==s))};return e.jsx("div",{className:"min-h-screen p-2 lg:p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-4xl lg:text-5xl font-bold text-white mb-4 tracking-tight",children:a.projectName}),e.jsxs("div",{className:"inline-block px-6 py-2 bg-blue-500/20 backdrop-blur-md rounded-full",children:[e.jsx("span",{className:"text-blue-300 font-medium",children:"Current Stage: "}),e.jsx("span",{className:"text-white font-semibold",children:y})]})]}),e.jsx("div",{className:"border border-white/20 shadow-2xl p-4 lg:p-8",children:e.jsxs("form",{onSubmit:j,className:"space-y-10",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex items-center text-white text-lg font-medium gap-2",children:[e.jsx(Ue,{className:"w-5 h-5 text-blue-400"}),"Work Details"]}),e.jsx("textarea",{value:g[0].details,onChange:s=>C([{...g[0],details:s.target.value}]),className:"w-full p-4 rounded-xl bg-white/5 border border-white/10 focus:border-blue-400/50 focus:ring-2 focus:ring-blue-400/20 text-white placeholder-gray-400 resize-none transition-all duration-200",placeholder:"Describe the work completed, materials used, and progress made...",rows:4,required:!0})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"flex items-center text-xl text-white font-semibold gap-2",children:[e.jsx(he,{className:"w-5 h-5 text-blue-400"}),"Materials Used"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.currentMaterials.map((s,t)=>{var n,c;return e.jsx("div",{className:`relative overflow-hidden rounded-xl backdrop-blur-md p-5 border transition-all duration-300 
    ${s.isApproved?"":"bg-yellow-500/10 border-yellow-500/30"}
    ${s.finished?"bg-green-500/10 border-green-500/30":""}
    ${s.quantity<=0&&s.isApproved?"bg-red-500/10 border-red-500/30":""}
    ${s.isApproved&&s.quantity>0&&!s.finished?"bg-white/5 border-white/20":""}
  `,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-white/10",children:s.isApproved?e.jsx(ue,{className:"w-6 h-6 text-green-400"}):e.jsx(I,{className:"w-6 h-6 text-yellow-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-300 flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-gray-400"}),"Available:"," ",e.jsx("span",{className:"text-white font-medium",children:s.quantity})]})]})]}),!s.isApproved&&e.jsxs("div",{className:"p-3 bg-yellow-500/10 border border-yellow-500/30 rounded-lg flex items-center gap-2",children:[e.jsx(I,{className:"w-5 h-5 text-yellow-400"}),e.jsx("span",{className:"text-yellow-400 font-medium",children:"Approval Pending"})]}),s.quantity<=0&&s.isApproved&&e.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg flex items-center gap-2",children:[e.jsx(I,{className:"w-5 h-5 text-red-400"}),e.jsx("span",{className:"text-red-400 font-medium",children:"Out of Stock"})]}),s.isApproved&&!s.finished&&s.quantity>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-2",children:"Quantity to Use"}),e.jsx("input",{type:"number",min:"0",value:((c=(n=g[0])==null?void 0:n.materialsUsed[t])==null?void 0:c.quantity)||0,onChange:d=>A(t,d.target.value),disabled:!s.isApproved||s.quantity<=0,required:!0,className:`w-full p-3 rounded-lg bg-white/5 border border-white/20 text-white placeholder-gray-400 \r
            focus:border-blue-400/50 focus:ring-2 focus:ring-blue-400/20 transition-all duration-200`})]})]})},t)})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"flex items-center text-xl text-white font-semibold gap-2",children:[e.jsx(ge,{className:"w-5 h-5 text-blue-400"}),"Workers Assigned"]}),e.jsxs("div",{className:"space-y-4",children:[g[0].workers.map((s,t)=>e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center bg-white/5 backdrop-blur-md p-4 rounded-xl border border-white/20",children:[e.jsx("input",{type:"text",placeholder:"Worker Name",value:s.name,onChange:n=>v(t,"name",n.target.value),required:!0,className:"flex-1 p-3 rounded-lg bg-white/5 border border-white/20 text-white placeholder-gray-400 focus:border-blue-400/50 focus:ring-2 focus:ring-blue-400/20 transition-all duration-200"}),e.jsx("input",{type:"number",placeholder:"Daily Wage",value:s.dailyWage,onChange:n=>v(t,"dailyWage",n.target.value),required:!0,className:"flex-1 p-3 rounded-lg bg-white/5 border border-white/20 text-white placeholder-gray-400 focus:border-blue-400/50 focus:ring-2 focus:ring-blue-400/20 transition-all duration-200"}),e.jsx("button",{type:"button",onClick:()=>b(t),className:"p-2 text-red-400 hover:text-red-300 transition-colors duration-200",children:e.jsx(je,{className:"w-5 h-5"})})]},t)),e.jsxs("button",{type:"button",onClick:p,className:"flex items-center gap-2 text-blue-400 hover:text-blue-300 transition-colors duration-200",children:[e.jsx(fe,{className:"w-5 h-5"}),"Add Worker"]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"flex items-center text-xl text-white font-semibold gap-2",children:[e.jsx(ye,{className:"w-5 h-5 text-blue-400"}),"Upload an image"]}),e.jsxs("div",{className:"max-w-lg p-6 rounded-2xl border border-white/10 bg-white/10 backdrop-blur-md shadow-lg",children:[e.jsxs("label",{className:"w-full cursor-pointer border-2 border-dashed border-blue-500/50 rounded-lg p-6 flex flex-col items-center justify-center gap-3 text-gray-200 hover:bg-white/5 transition-all",children:[e.jsx(be,{className:"w-10 h-10 text-blue-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-200",children:"Click or Drag & Drop Images"}),e.jsx("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:r})]}),S.length>0&&e.jsx("div",{className:"mt-6 grid grid-cols-3 gap-3",children:S.map((s,t)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:s,alt:`Upload Preview ${t}`,className:"w-full h-24 object-cover rounded-lg shadow-md"}),e.jsx("button",{onClick:()=>o(t),className:"absolute top-1 right-1 bg-red-500 p-1 rounded-full opacity-0 group-hover:opacity-100 transition-all",children:e.jsx(Ne,{className:"text-white w-5 h-5"})})]},t))})]})]}),e.jsxs("button",{type:"submit",className:"w-max py-4 px-6 bg-gradient-to-r from-blue-800 to-purple-900 hover:from-blue-700 hover:to-purple-800 text-white rounded-xl transition-all duration-300 flex items-center justify-center gap-2 font-semibold text-lg shadow-lg shadow-blue-900/25",disabled:f,children:[!f&&e.jsx(Pe,{className:"w-5 h-5"}),f?e.jsx(we,{}):"Review & Submit"]})]})})]})})},$e=()=>{const g=ve(),{users:C,fetchUsers:y,projects:a,fetchProject:v,electricaURL:p}=ke(),{projectId:b}=Ce(),[j,f]=i.useState(null),[S,N]=i.useState(!0),[A,r]=i.useState(!1),[o,s]=i.useState(""),[t,n]=i.useState([{details:"",materialsUsed:[],workers:[],images:[],date:""}]),[c,d]=i.useState(null),[z,V]=i.useState(!1),[H,Q]=i.useState(!1),[B,Y]=i.useState([]),[G,X]=i.useState([]),[D,W]=i.useState("");if(i.useEffect(()=>{setTimeout(()=>{if(a&&a.length>0){const m=a.find(x=>x._id===b);if(m){f(m),N(!1);const x=m.stages.find(l=>!l.isCompleted);Y(m.clientMessages),X(m.adminMessages),m.stages.every(l=>l.isCompleted)&&Q(!0),x&&(s(x.name),n(l=>[{...l[0],details:"",materialsUsed:x.materials.map(M=>({name:M.name,quantity:0})),workers:[],images:[],date:new Date().toISOString()}]),f(l=>({...l,currentMaterials:x.materials})))}}},1400),setTimeout(()=>V(!0),6e3)},[C,a,b]),S)return e.jsx("div",{className:"grid place-content-center min-h-screen",children:e.jsx(_,{})});const Z=async w=>{var h,l,M,k,E,L,$;if(w.preventDefault(),r(!0),!((h=t[0])!=null&&h.materialsUsed)){d({type:"error",message:"Please provide work details."});return}if((l=t[0])==null?void 0:l.materialsUsed.some(u=>!u.name||u.quantity<=0)){d({type:"error",message:"All materials must have a valid name and quantity."}),r(!1);return}((M=t[0])==null?void 0:M.materialsUsed.every((u,R)=>!(!u.name||typeof u.quantity!="number"||u.quantity<=0)))?(d(null),r(!1)):(d({type:"error",message:"All materials must have a valid name and quantity."}),r(!1));try{const u=await P.post(`${p}/api/adminauth/projectdaily-update`,{projectId:b,stageName:o,updates:t},{withCredentials:!0});u.status===200?(d({type:u.data.type,message:u.data.message}),n([{details:"",materialsUsed:t[0].materialsUsed.map(R=>({name:R.name,quantity:0})),workers:[],images:[],date:""}]),v(),r(!1)):(d({type:u.data.type,message:u.data.message}),r(!1))}catch(u){d({type:(E=(k=u.response)==null?void 0:k.data)==null?void 0:E.type,message:($=(L=u.response)==null?void 0:L.data)==null?void 0:$.message}),r(!1)}},J=async(w,m)=>{var x,h,l,M;N(!0);try{const k=await P.post(`${p}/api/adminauth/complete-stage`,{projectId:w,stageName:m},{withCredentials:!0});k.status===200?(d({type:k.data.type,message:k.data.message}),y()):(d({type:k.data.type,message:k.data.message}),N(!1))}catch(k){N(!1),d({type:(h=(x=k.response)==null?void 0:x.data)==null?void 0:h.type,message:(M=(l=k.response)==null?void 0:l.data)==null?void 0:M.message})}},K=(w,m,x)=>{const h=[...t[0].workers];h[w]={...h[w],[m]:x},n([{...t[0],workers:h}])},ee=()=>{n([{...t[0],workers:[...t[0].workers,{name:"",dailyWage:0}]}])},se=w=>{const m=t[0].workers.filter((x,h)=>h!==w);n([{...t[0],workers:m}])};if(!j)return e.jsxs("div",{className:"text-2xl flex gap-2 text-orange-2 flex-col items-center justify-center",children:[e.jsx("span",{className:"text-white",children:"Project Not Found"}),e.jsx("span",{className:"text-cyan-800 underline",children:e.jsx(U,{to:-1,children:"Previous"})})]});if(j.status!=="approved")return e.jsxs("div",{className:"text-2xl flex gap-2 text-orange-2 flex-col items-center justify-center",children:[e.jsx("span",{className:"text-white",children:"Project No tApproved Yet"}),e.jsx("span",{className:"text-cyan-800 underline",children:e.jsx(U,{to:-1,children:"Previous"})})]});if(!j.startStage)return e.jsxs("div",{className:"text-2xl flex gap-2 text-orange-2 flex-col items-center justify-center",children:[e.jsx("span",{className:"text-white",children:"Project Not Started"}),e.jsx("span",{className:"text-cyan-800 underline",children:e.jsx(U,{to:-1,children:"Previous"})})]});const te=async()=>{var w,m,x,h;try{const l=await P.post(`${p}/api/adminauth/message-client`,{projectId:b,stageName:o,message:D},{withCredentials:!0});l.status===200?(d({type:l.data.type,message:l.data.message}),W(""),v(),y()):d({type:l.data.type,message:l.data.message})}catch(l){d({type:(m=(w=l.response)==null?void 0:w.data)==null?void 0:m.type,message:(h=(x=l.response)==null?void 0:x.data)==null?void 0:h.message})}};return H?e.jsxs("div",{className:"w-full min-h-screen flex flex-col justify-center items-center text-white p-8 lg:p-3",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Project Stages"}),e.jsx("p",{className:"mb-6",children:"All stages are successfully completed!"}),e.jsx(U,{to:`/db_au_admn/projectusers/bill/${j._id}`,className:"bg-blue-500 text-white px-6 py-3 rounded-xl hover:bg-blue-600 transition",children:"Proceed to Next Step"})]}):e.jsxs("div",{className:"relative text-gray-200 p-1 sm:p-4",children:[e.jsxs("button",{className:"p-2 text-white hover:text-blue-400 transition-colors duration-200 flex gap-2 items-center select-none",title:"Go back",children:[e.jsx(Se,{className:"w-6 h-6"}),e.jsxs("div",{className:"text-md",children:[e.jsx("span",{className:"text-gray-200 hover:text-blue-600 cursor-pointer select-none",onClick:()=>g("/db_au_admn/projectusers"),children:"Projectusers"}),e.jsx("span",{className:"text-gray-200 select-none",children:" / "}),e.jsx("span",{className:"text-gray-500 select-none",children:"Add details"})]})]}),c&&e.jsx(Ae,{type:c.type,message:c.message,onClose:()=>d(null)}),e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx(De,{projectId:b,electricaURL:p,stageName:o,users:C,onCompleteStage:J})}),e.jsx(We,{updates:t,setUpdates:n,stageName:o,project:j,handleWorkerChange:K,handleAddWorker:ee,handleRemoveWorker:se,handleSubmit:Z,formLoader:A}),z&&e.jsx("div",{className:"mt-10 w-full p-2",children:e.jsx(Ie,{electricaURL:p,projectId:b,stageName:o})}),e.jsx(Me,{messageUser:B,messageAdmin:G,setMessage:W,message:D,sendMessageToAdmin:te})]})};export{$e as default};
